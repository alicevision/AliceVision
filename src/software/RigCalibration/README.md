## RIG Calibration

`openMVG_main_rigCalibration` is used to calibrate a rig of cameras.

### Usage:

```
This program is used to calibrate a camera rig composed of internally calibrated cameras:
  -h [ --help ]                         Print this message
  -d [ --sfmdata ] arg                  The sfm_data.json kind of file 
                                        generated by OpenMVG [it could be also 
                                        a bundle.out to use an older version of
                                        OpenMVG]
  -s [ --siftPath ] arg                 Folder containing the .desc. If not 
                                        provided, it will be assumed to be 
                                        parent(sfmdata)/matches [for the older 
                                        version of openMVG it is the list.txt]
  -m [ --mediapath ] arg                The folder path containing all the 
                                        synchronised image subfolders assocated
                                        to each camera
  - [ --refineIntrinsics ]              Enable/Disable camera intrinsics 
                                        refinement for each localized image
  --nCameras arg (=3)                   Number of cameras composing the rig
  - [ --preset ] arg (=NORMAL)          Preset for the feature extractor when 
                                        localizing a new image 
                                        {LOW,NORMAL,HIGH,ULTRA}
  - [ --descriptors ] arg (=SIFT)       Type of descriptors to use
  -t [ --voctree ] arg                  Filename for the vocabulary tree
  -w [ --weights ] arg                  Filename for the vocabulary tree 
                                        weights
  - [ --algorithm ] arg (=FirstBest)    Algorithm type: FirstBest=0, 
                                        BestResult=1, AllResults=2, Cluster=3
  -r [ --results ] arg (=10)            Number of images to retrieve in 
                                        database
  --nNearestKeyFrames arg (=5)          Number of images to retrieve in 
                                        database
  -e [ --export ] arg (=trackedcameras.abc)
                                        Filename for the SfM_Data export file 
                                        (where camera poses will be stored). 
                                        Default : trackedcameras.json If 
                                        Alambic is enable it will also export 
                                        an .abc file of the scene with the same
                                        name
```

For the `mediapath` option the following folder structure is assumed. The directory 
pointed by `mediapath` must contain a folder for each camera composing the rig, 
numbered from 0 to N. Inside each folder there must be the intrinsics parameters 
of the camera and the images to be used for the calibration. The images must be 
numbered so that they can be read as synchronized image pairs, ie the first image 
read in each directory must refer to the same acquisition timestamp and so on.
Here is an example of a possible hierarchy of directories:

```
mediapath
  |_0
  | |_ intrinsics.txt
  | |_ image0000.jpg
  | |_ image0001.jpg
  | 
  |_1
  | |_ intrinsics.txt
  | |_ image_0000.png
  |
  ...
```
so that `image0000.jpg` and `image_0000.png` refers to the images taken at the same time stamp.

`intrinsics.txt` is a plain text file containing the internal camera parameters in the following format (as output by `main_cameraCalibration.cpp`):
```
 int #image width
 int #image height
 double #focal
 double #ppx principal point x-coord
 double #ppy principal point y-coord
 double #k0 first distortion parameter
 double #k1
 double #k2
```
